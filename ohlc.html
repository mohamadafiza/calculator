<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OHLC</title>
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Calibri', sans-serif;
      background: linear-gradient(to right, #ffffff, #e6e6e6);
      padding: 40px;
      margin: 0;
      color: #000;
      user-select: none;
    }
    body::selection { background: none; }
    .container {
      max-width: 600px;
      margin: auto;
      background: linear-gradient(145deg, #d4e4ff, #f2f7ff);
      padding: 30px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      border-radius: 25px;
      border: 1px solid #0000ff;
      position: relative;
    }
    .container::before {
      content: "";
      position: absolute;
      top: -12px;
      left: 50%;
      transform: translateX(-50%);
      width: 160px;
      height: 6px;
      background: #ff0000;
      border-radius: 10px;
      box-shadow: 0 0 15px #ff0000;
    }
    h2 {
      text-align: center;
      color: #000;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
      font-size: 1.6rem;
      margin: 0.25rem 0;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
      color: #000;
    }
    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border-radius: 10px;
      border: 1px solid #0000ff;
      background: #ffffff;
      color: #000;
      font-size: 1rem;
      box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
    }
    button {
      margin-top: 25px;
      width: 100%;
      padding: 15px;
      background: linear-gradient(45deg, #ff0000, #0000ff);
      border: none;
      color: #fff;
      font-size: 1.1rem;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.2);
      transition: transform 0.3s;
    }
    button:hover { transform: scale(1.05); }
    .result {
      margin-top: 30px;
      background: rgba(255, 255, 255, 0.8);
      padding: 20px;
      border-left: 6px solid #0000ff;
      border-radius: 12px;
      box-shadow: inset 0 0 15px rgba(0,0,0,0.1);
      color: #000;
    }
    .result p { margin: 10px 0; }
    strong { color: #ff0000; }
    #live-price {
      text-align: center;
      margin-top: 10px;
      color: #0000ff;
      font-size: 0.9rem;
    }
    .instructions {
      margin: 16px auto 0;
      background: #ffffff;
      border: 1px solid #0000ff;
      border-radius: 14px;
      box-shadow: 0 10px 24px rgba(0,0,0,0.12);
      overflow: hidden;
    }
    .instructions .hdr {
      background: linear-gradient(90deg, #0000ff, #4d79ff);
      color: #fff;
      padding: 14px 18px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .instructions .body { padding: 18px; color: #000; }
    .instructions ol { margin: 0; padding-left: 18px; }
    .note {
      margin-top: 12px;
      padding: 12px;
      background: #f6f9ff;
      border-left: 4px solid #ff0000;
      border-radius: 8px;
      font-size: 0.95rem;
    }
    details.disc {
      margin-top: 14px;
      background: #fff;
      border: 1px dashed #b3c6ff;
      border-radius: 10px;
      padding: 10px 14px;
    }
    details.disc summary { font-weight: 700; cursor: pointer; }
  </style>
</head>
<body>
  <div class="container">
    <h2>OHLC D1 & W1</h2>
    <h2>Untuk VIP ‚Äì Fokus sepenuhnya pada <u>‚ÄúSniper Entry‚Äù</u> sahaja, masuk besar & agresif hanya pada ruang tersebut</h2>

    <!-- Panel Arahan -->
    <section class="instructions" aria-labelledby="arahan-title">
      <div class="hdr">
        <span>üìò</span>
        <span id="arahan-title">Arahan Penggunaan</span>
      </div>
      <div class="body">
        <ol>
          <li>Pilih <em>Trading Instrument</em> yang dikehendaki.</li>
          <li>Klik <strong>Fetch OHLC (D1)</strong> untuk tarik data harian terbaru.<br>
              Jika API fails (e.g., non-supported symbols), masukkan nilai <strong>Open/High/Low/Close (D1)</strong> manually from TradingView/MT4.</li>
          <li>Tetapkan <strong>Account Balance (USD)</strong> dan <strong>Risk Per Trade (%)</strong>.</li>
          <li>Pilih <strong>H4 Confirmation Candle</strong> (optional) mengikut analisis anda.</li>
          <li>Klik <strong>Calculate</strong> untuk hasil <em>Signal</em>, <em>TP</em>, <em>Entry Zone</em>, <em>SL</em> dan <em>lot size</em>.</li>
          <li>Klik <strong>Copy Signal</strong> untuk salin keputusan ke papan klip.</li>
        </ol>
        <div class="note">
          <strong>üìå Arahan Trading D1 (Timezone Malaysia UTC+8)</strong>
          <ul>
            <li>Candle D1 <strong>tutup setiap hari pada 08:00 pagi</strong>.</li>
            <li><strong>Tunggu hingga 08:02 pagi</strong> untuk pastikan data close lengkap.</li>
            <li><strong>Selepas 08:02 pagi</strong> ‚Üí buat analisis/entry/pending order.</li>
            <li><strong>Jangan guna signal D1 sebelum 08:00 pagi</strong>.</li>
          </ul>
        </div>
        <details class="disc">
          <summary>Nasihat & Sikap Dagangan</summary>
          <p>Elakkan sikap tergesa-gesa untuk meraih keuntungan besar dalam masa singkat. Trading yang berkesan memerlukan <strong>disiplin, kesabaran, dan konsistensi</strong>, bukan sekadar keberanian mengambil risiko tinggi.</p>
          <ul>
            <li><strong>Pengurusan risiko</strong> ‚Äî Tetapkan saiz lot dan <em>stop loss</em> yang sesuai dengan modal.</li>
            <li><strong>Fokus pada proses</strong> ‚Äî Ukur kejayaan berdasarkan kepatuhan pada strategi, bukan jumlah profit harian.</li>
            <li><strong>Kesedaran emosi</strong> ‚Äî Jangan biarkan euforia atau panik mengawal keputusan.</li>
            <li><strong>Pertumbuhan berterusan</strong> ‚Äî Asah analisis dan disiplin; profit akan datang secara beransur-ansur bila asas kukuh.</li>
          </ul>
          <blockquote>Trading bukan perlumbaan jangka pendek, tetapi perjalanan maraton.</blockquote>
        </details>
      </div>
    </section>

    <!-- Full Pilihan pair -->
    <label for="pair">Select Trading Instrument:</label>
    <select id="pair">
      <optgroup label="Major Pairs">
        <option value="EUR/USD">EUR/USD</option>
        <option value="USD/JPY">USD/JPY</option>
        <option value="GBP/USD">GBP/USD</option>
        <option value="USD/CHF">USD/CHF</option>
        <option value="USD/CAD">USD/CAD</option>
        <option value="AUD/USD">AUD/USD</option>
        <option value="NZD/USD">NZD/USD</option>
      </optgroup>
      <optgroup label="Minor Pairs">
        <option value="AUD/CAD">AUD/CAD</option>
        <option value="AUD/CHF">AUD/CHF</option>
        <option value="AUD/JPY">AUD/JPY</option>
        <option value="AUD/NZD">AUD/NZD</option>
        <option value="CAD/CHF">CAD/CHF</option>
        <option value="CAD/JPY">CAD/JPY</option>
        <option value="CHF/JPY">CHF/JPY</option>
        <option value="EUR/AUD">EUR/AUD</option>
        <option value="EUR/CAD">EUR/CAD</option>
        <option value="EUR/CHF">EUR/CHF</option>
        <option value="EUR/GBP">EUR/GBP</option>
        <option value="EUR/JPY">EUR/JPY</option>
        <option value="EUR/NZD">EUR/NZD</option>
        <option value="GBP/AUD">GBP/AUD</option>
        <option value="GBP/CAD">GBP/CAD</option>
        <option value="GBP/CHF">GBP/CHF</option>
        <option value="GBP/JPY">GBP/JPY</option>
        <option value="GBP/NZD">GBP/NZD</option>
        <option value="NZD/CAD">NZD/CAD</option>
        <option value="NZD/CHF">NZD/CHF</option>
        <option value="NZD/JPY">NZD/JPY</option>
      </optgroup>
      <optgroup label="Metals">
        <option value="XAU/USD">XAU/USD (Gold)</option>
        <option value="XAU/EUR">XAU/EUR (Gold/EUR)</option>
        <option value="XAG/USD">XAG/USD (Silver)</option>
        <option value="XPT/USD">XPT/USD (Platinum)</option>
      </optgroup>
      <optgroup label="Cryptocurrencies">
        <option value="ADA/USD">ADA/USD (Cardano, Manual)</option>
        <option value="BTC/USD">BTC/USD (Bitcoin, Manual)</option>
        <option value="DOGE/USD">DOGE/USD (Dogecoin, Manual)</option>
        <option value="ETH/USD">ETH/USD (Ethereum, Manual)</option>
        <option value="LTC/USD">LTC/USD (Litecoin, Manual)</option>
        <option value="XRP/USD">XRP/USD (Ripple, Manual)</option>
      </optgroup>
      <optgroup label="Indices">
        <option value="AUS200">AUS200 (Australia 200, Manual)</option>
        <option value="DE30">DE30 (DAX Germany, Manual)</option>
        <option value="FRA40">FRA40 (France 40, Manual)</option>
        <option value="HK50">HK50 (Hong Kong 50, Manual)</option>
        <option value="JP225">JP225 (Nikkei 225, Manual)</option>
        <option value="SPX500">SPX500 (S&P 500, Manual)</option>
        <option value="UK100">UK100 (FTSE 100, Manual)</option>
        <option value="US30">US30 (Dow Jones, Manual)</option>
        <option value="NAS100">US100 (Nasdaq 100, Manual)</option>
      </optgroup>
    </select>

    <p id="live-price">Live price will appear here...</p>
    <button onclick="fetchOHLC()">Fetch OHLC (D1)</button>
    <label for="balance">Account Balance (USD):</label>
    <input type="number" id="balance" value="144.00">
    <label for="risk">Risk Per Trade (%):</label>
    <input type="number" id="risk" value="2.1" step="0.1" min="0.1" max="10">
    <label for="open">Open (D1):</label>
    <input type="number" id="open" step="0.0001">
    <label for="high">High (D1):</label>
    <input type="number" id="high" step="0.0001">
    <label for="low">Low (D1):</label>
    <input type="number" id="low" step="0.0001">
    <label for="close">Close (D1):</label>
    <input type="number" id="close" step="0.0001">
    <label for="h4confirm">H4 Confirmation Candle (Manual):</label>
    <select id="h4confirm">
      <option value="none">No Confirmation</option>
      <option value="engulfing">Engulfing</option>
      <option value="pinbar">Pin Bar</option>
      <option value="insidebar">Inside Bar</option>
    </select>
    <button onclick="calculateSniper()">Calculate</button>
    <button onclick="copySignal()">Copy Signal</button>
    <div class="result" id="result" style="display: none;"></div>
  </div>

  <script>
    // Sekatan interaksi
    document.addEventListener('contextmenu', e => e.preventDefault());
    document.addEventListener('keydown', function (e) {
      if (
        e.key === "F12" ||
        (e.ctrlKey && e.shiftKey && ["I", "J", "C"].includes(e.key)) ||
        (e.ctrlKey && e.key === "U")
      ) { e.preventDefault(); }
    });
    document.addEventListener("dragstart", e => e.preventDefault());

    async function fetchOHLC() {
      const apiKey = '1de1fdb0f730464aba50d0b3d983f1f8'; // Your TwelveData API key
      const pair = document.getElementById('pair').value;
      const symbol = pair; // Use the pair value directly (e.g., XAU/USD, EUR/USD)

      const url = `https://api.twelvedata.com/time_series?symbol=${encodeURIComponent(symbol)}&interval=1day&outputsize=1&apikey=${apiKey}`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        if (data.status === 'ok' && data.values && data.values.length) {
          const latest = data.values[0];
          document.getElementById('open').value = parseFloat(latest.open).toFixed(5);
          document.getElementById('high').value = parseFloat(latest.high).toFixed(5);
          document.getElementById('low').value = parseFloat(latest.low).toFixed(5);
          document.getElementById('close').value = parseFloat(latest.close).toFixed(5);
          document.getElementById('live-price').innerText = `${pair} D1 Close (Sept 9): ${parseFloat(latest.close).toFixed(5)}`;
        } else {
          alert(`Failed to fetch ${pair}: ${data.message || 'No data or unsupported symbol'}. Use manual entry.`);
          document.getElementById('live-price').innerText = `Enter ${pair} OHLC manually (e.g., from TradingView)`;
          document.getElementById('open').value = '';
          document.getElementById('high').value = '';
          document.getElementById('low').value = '';
          document.getElementById('close').value = '';
        }
      } catch (e) {
        alert(`Fetch failed for ${pair}: ${e.message}. Use manual entry.`);
        document.getElementById('live-price').innerText = `Enter ${pair} OHLC manually (e.g., from TradingView)`;
        document.getElementById('open').value = '';
        document.getElementById('high').value = '';
        document.getElementById('low').value = '';
        document.getElementById('close').value = '';
      }
    }

    function calculateSniper() {
      const balance = parseFloat(document.getElementById('balance').value);
      const riskPercent = parseFloat(document.getElementById('risk').value) / 100;
      const open = parseFloat(document.getElementById('open').value);
      const high = parseFloat(document.getElementById('high').value);
      const low = parseFloat(document.getElementById('low').value);
      const close = parseFloat(document.getElementById('close').value);
      const h4confirm = document.getElementById('h4confirm').value;
      const pair = document.getElementById('pair').value;

      if ([balance, riskPercent, open, high, low, close].some(isNaN)) {
        alert("Please enter all values correctly.");
        return;
      }

      let pipValue, pipMultiplier;
      if (pair.includes('XAU') || pair.includes('XAG') || pair.includes('XPT')) {
        pipValue = 1; pipMultiplier = 100; // Metals: $1 per 0.01
      } else if (['AUS200', 'DE30', 'FRA40', 'HK50', 'JP225', 'SPX500', 'UK100', 'US30', 'NAS100'].some(idx => pair.includes(idx))) {
        pipValue = 50; pipMultiplier = 1; // Indices: $50 per point
      } else if (pair.includes('DOGE')) {
        pipValue = 0.01; pipMultiplier = 10000; // DOGE: $0.01 per 0.0001
      } else if (pair.includes('ADA') || pair.includes('BTC') || pair.includes('ETH') || pair.includes('LTC') || pair.includes('XRP')) {
        pipValue = 0.1; pipMultiplier = 100; // Cryptos: $0.1 per 0.01
      } else {
        pipValue = pair.includes('JPY') ? 9 : 10; pipMultiplier = 10000; // Forex: $10/pip, JPY $9
      }

      const signal = close > open ? 'BUY' : 'SELL';
      const tp = signal === 'BUY' ? high : low;
      const sl = signal === 'BUY' ? low : high;
      const risk = balance * riskPercent;
      const sl_pips = (Math.abs(open - sl) * pipMultiplier).toFixed(2);
      const lot = (risk / (sl_pips * pipValue)).toFixed(2);

      const body = Math.abs(close - open);
      let entryZoneLow, entryZoneHigh;
      if (signal === 'BUY') {
        entryZoneLow = open.toFixed(5);
        entryZoneHigh = (open + body * 0.5).toFixed(5);
      } else {
        entryZoneHigh = open.toFixed(5);
        entryZoneLow = (open - body * 0.5).toFixed(5);
      }

      const confirmationNote = h4confirm !== 'none'
        ? `<p><strong>H4 Confirmation:</strong> ${h4confirm.charAt(0).toUpperCase() + h4confirm.slice(1)}</p>`
        : `<p><strong>H4 Confirmation:</strong> None ‚Äì Trade entry not recommended</p>`;

      const resultBox = document.getElementById('result');
      resultBox.innerHTML = `
        <p><strong>Signal:</strong> ${signal}</p>
        <p><strong>Take Profit (TP):</strong> ${tp.toFixed(5)}</p>
        <p><strong>SNIPER ENTRY:</strong> ${sl.toFixed(5)}</p>
        <p><strong>ENTRY 2 dan ENTRY 1:</strong> ${entryZoneLow} - ${entryZoneHigh}</p>
        <p><strong>Stop Loss (Pips/Points):</strong> ${sl_pips}</p>
        <p><strong>Recommended Lot Size:</strong> ${lot}</p>
        ${confirmationNote}
      `;
      resultBox.style.display = 'block';
    }

    function copySignal() {
      const resultBox = document.getElementById('result');
      if (resultBox.style.display === 'none') {
        alert("No signal to copy. Please run a calculation first.");
        return;
      }
      navigator.clipboard.writeText(resultBox.innerText)
        .then(() => alert("Signal copied to clipboard!"))
        .catch(() => alert("Copy failed."));
    }
  </script>
</body>
</html>
